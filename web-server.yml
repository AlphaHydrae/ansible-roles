---
- hosts: web-server
  vars:
    FIREWALL: firewalld
    NGINX_WORKERS: 5
    NGINX_WORKER_CONNECTIONS: 1024
  user: root
  connection: ssh
  roles:
    - { role: firewall, tags: [ firewall ] }
    - { role: server, tags: [ system ] }
    - { role: mail-server, tags: [ mail ] }
    - { role: postgresql-server, tags: [ db ] }
    - { role: web-server, tags: [ web ] }
    - { role: nginx-server, tags: [ nginx ] }
    - { role: git-stack, tags: [ git ] }
    - { role: git-server, tags: [ git ] }
    - { role: node-stack, tags: [ node ] }
  tasks:
    - include: common/authorized_keys.yml USER=git
